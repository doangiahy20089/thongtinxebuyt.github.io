<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bus Schedule Display</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse {
            0%, 100% {
                opacity: 0.8;
            }

            50% {
                opacity: 1;
            }
        }

        <!DOCTYPE html >
        <html lang="vi" >
        <head >
        <meta charset="UTF-8" / >
        <meta name="viewport" content="width=device-width, initial-scale=1.0" / >
        <title > Tuyến xe buýt</title >
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" / >
        <style >
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            background-color: #fff;
            color: #000;
            transition: background-color 0.3s, color 0.3s;
        }

        .dark-mode {
            background-color: #121212;
            color: #fff;
        }

        header {
            background-color: #2196F3;
            color: white;
            padding: 1rem;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        #resetPage {
            cursor: pointer;
        }

        #darkModeToggle {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.3rem 0.6rem;
            border: none;
            background: white;
            color: #2196F3;
            border-radius: 4px;
            cursor: pointer;
        }

        .bus-list {
            display: flex;
            justify-content: center;
            gap: 1rem;
            padding: 1rem;
        }

        .bus-card {
            width: 120px;
            padding: 0.5rem;
            border: 2px solid #ccc;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
        }

            .bus-card img {
                width: 100%;
                border-radius: 8px;
            }

            .bus-card.selected {
                border-color: #2196F3;
            }

        #map {
            height: 400px;
            margin: 1rem;
            border-radius: 10px;
        }

        #stop-list {
            margin: 1rem;
            padding: 1rem;
            border: 1px solid #ccc;
            border-radius: 10px;
            background: #f9f9f9;
        }

        .dark-mode #stop-list {
            background: #1e1e1e;
            border-color: #555;
        }
    </style>
</head>
<body>
    <header>
        <h1 id="resetPage">THÔNG TIN XE BUÝT</h1>
        <button id="darkModeToggle">🌙</button>
    </header>

    <div class="bus-list">
        <div class="bus-card" data-bus="8">
            <img src="xe8.jpg" alt="Xe buýt tuyến 8" />
            <p>Tuyến 08</p>
        </div>
        <div class="bus-card" data-bus="9">
            <img src="xe9.jpg" alt="Xe buýt tuyến 9" />
            <p>Tuyến 09</p>
        </div>
        <div class="bus-card" data-bus="10">
            <img src="xe10.jpg" alt="Xe buýt tuyến 10" />
            <p>Tuyến 10</p>
        </div>
    </div>

    <div id="map"></div>

    <div id="stop-list">
        <h3>Danh sách trạm sẽ đi qua:</h3>
        <ul id="stops"></ul>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const darkModeBtn = document.getElementById("darkModeToggle");
        darkModeBtn.addEventListener("click", () => {
            document.body.classList.toggle("dark-mode");
        });

        // Reset page when clicking on the title
        document.getElementById("resetPage").addEventListener("click", () => {
            location.reload();
        });

        const busCards = document.querySelectorAll(".bus-card");
        const stopList = document.getElementById("stops");
        let map = L.map('map').setView([10.75, 106.65], 12);
        let routeLayer = null;
        let stopMarkers = [];
        let userMarker = null;

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap contributors'
        }).addTo(map);

        const busRoutes = {
            "8": {
                color: "blue",
                coords: [
                    [10.740, 106.665, "Bến xe buýt Quận 8"],
                    [10.743, 106.667, "Đường Tạ Quang Bửu"],
                    [10.750, 106.660, "Quốc lộ 50"],
                    [10.755, 106.655, "Cầu Nhị Thiên Đường"],
                    [10.760, 106.660, "Đường Tùng Thiện Vương"],
                    [10.765, 106.662, "Cầu Chà Và"],
                    [10.768, 106.663, "Đường Hải Thượng Lãn Ông"],
                    [10.770, 106.664, "Đường Triệu Quang Phục"],
                    [10.772, 106.665, "Đường Châu Văn Liêm"],
                    [10.775, 106.667, "Đường Hồng Bàng"],
                    [10.780, 106.670, "Đường Lý Thường Kiệt"],
                    [10.785, 106.672, "Đường Hoàng Văn Thụ"],
                    [10.790, 106.675, "Đường Phan Đăng Lưu"],
                    [10.795, 106.678, "Đường Bạch Đằng"],
                    [10.800, 106.680, "Đường Xô Viết Nghệ Tĩnh"],
                    [10.805, 106.683, "Quốc lộ 13"],
                    [10.810, 106.685, "Đường Phạm Văn Đồng"],
                    [10.815, 106.688, "Đường Kha Vạn Cân"],
                    [10.820, 106.690, "Đường Võ Văn Ngân"],
                    [10.825, 106.693, "Ngã tư Thủ Đức"],
                    [10.830, 106.695, "Xa lộ Hà Nội"],
                    [10.835, 106.698, "Quốc lộ 1"],
                    [10.840, 106.700, "Cầu vượt quay đầu"],
                    [10.850, 106.703, "Đường 621"],
                    [10.860, 106.705, "Quảng trường Sáng Tạo"],
                    [10.865, 106.707, "Đường Vành Đai"],
                    [10.868, 106.709, "Đường Nguyễn Hiền"],
                    [10.870, 106.800, "Bến xe buýt Khu A ĐHQG TP.HCM"]
                ]
            },
            "9": {
                color: "green",
                coords: [
                    [10.755, 106.635, "Bến xe buýt Chợ Lớn (Bến A)"],
                    [10.758, 106.637, "Đường Lê Quang Sung"],
                    [10.760, 106.638, "Đường Phạm Đình Hổ"],
                    [10.765, 106.640, "Đường Hồng Bàng"],
                    [10.770, 106.645, "Đường Kinh Dương Vương"],
                    [10.775, 106.648, "Quốc lộ 1"],
                    [10.780, 106.650, "Đường Đinh Đức Thiện"],
                    [10.785, 106.653, "Hương lộ 11"],
                    [10.790, 106.655, "Hưng Long"]
                ]
            },
            "10": {
                color: "red",
                coords: [
                    [10.740, 106.620, "Bến xe Miền Tây"],
                    [10.745, 106.625, "Đường Kinh Dương Vương"],
                    [10.750, 106.630, "Đường Hậu Giang"],
                    [10.755, 106.635, "Đường Tháp Mười"],
                    [10.760, 106.640, "Đường Hải Thượng Lãn Ông"],
                    [10.765, 106.645, "Đường Châu Văn Liêm"],
                    [10.770, 106.650, "Đường Hồng Bàng"],
                    [10.775, 106.655, "Đường An Dương Vương"],
                    [10.780, 106.660, "Đường Nguyễn Tri Phương"],
                    [10.785, 106.665, "Đường 3 Tháng 2"],
                    [10.790, 106.670, "Đường Lý Thái Tổ"],
                    [10.795, 106.675, "Đường Điện Biên Phủ"],
                    [10.800, 106.680, "Đường Võ Nguyên Giáp"],
                    [10.805, 106.685, "Xa lộ Hà Nội"],
                    [10.810, 106.690, "Quốc lộ 1"],
                    [10.815, 106.695, "Cầu vượt quay đầu"],
                    [10.820, 106.700, "Đường song hành bờ Nam Quốc lộ 1"],
                    [10.825, 106.705, "Đường 621"],
                    [10.830, 106.710, "Quảng Trường Sáng Tạo"],
                    [10.835, 106.715, "Đường Vành Đai"],
                    [10.840, 106.720, "Đường Nguyên Hiền"],
                    [10.845, 106.725, "Bến xe buýt khu A Đại học Quốc gia TP.HCM"]
                ]
            }
        };

        busCards.forEach(card => {
            card.addEventListener("click", () => {
                busCards.forEach(c => c.classList.remove("selected"));
                card.classList.add("selected");

                const busNumber = card.dataset.bus;
                const route = busRoutes[busNumber];

                if (routeLayer) routeLayer.remove();
                stopMarkers.forEach(marker => marker.remove());
                stopMarkers = [];
                stopList.innerHTML = "";

                const polyCoords = route.coords.map(c => [c[0], c[1]]);
                map.setView(polyCoords[0], 13);
                routeLayer = L.polyline(polyCoords, {
                    color: route.color,
                    weight: 5,
                    opacity: 0.8
                }).addTo(map);

                route.coords.forEach(([lat, lng, name], index) => {
                    const marker = L.marker([lat, lng]).addTo(map).bindPopup(name);
                    stopMarkers.push(marker);
                    const li = document.createElement("li");
                    li.textContent = `${index + 1}. ${name}`;
                    stopList.appendChild(li);
                });

                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(position => {
                        const latlng = [position.coords.latitude, position.coords.longitude];
                        if (userMarker) userMarker.remove();
                        userMarker = L.marker(latlng).addTo(map).bindPopup("Vị trí của bạn").openPopup();
                    });
                }
            });
        });
    </script>
</body>
</html>


        .led-on {
            background-color: #4ade80 !important;
            box-shadow: 0 0 10px 5px rgba(74, 222, 128, 0.7);
            animation: pulse 2s infinite;
        }

        .led-off {
            background-color: #666 !important;
        }

        .cancel-message {
            display: none;
            font-size: 20px;
            color: red;
            margin-top: 20px;
        }

        .prompt-message {
            font-size: 20px;
            color: blue;
            margin-top: 20px;
        }

        /* Dark mode styles */
        .dark {
            background-color: #1a202c;
            color: #e2e8f0;
        }

            .dark .bg-white {
                background-color: #2d3748 !important;
            }

            .dark .text-gray-800 {
                color: #f7fafc !important;
            }

            .dark .text-gray-600 {
                color: #cbd5e0 !important;
            }

            .dark .bg-gray-50 {
                background-color: #4a5568 !important;
            }

            .dark .bg-blue-800 {
                background-color: #2b6cb0 !important;
            }

            .dark .border-gray-200 {
                border-color: #718096 !important;
            }

            .dark .bg-blue-50 {
                background-color: #2c5282 !important;
            }

            .dark .text-blue-800 {
                color: #bee3f8 !important;
            }

        .toggle-dark {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background-color: #ddd;
            border: none;
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            font-weight: bold;
            cursor: pointer;
        }

        .dark .toggle-dark {
            background-color: #4a5568;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4 transition-colors duration-300">
    <div class="w-full max-w-4xl bg-white rounded-xl shadow-2xl overflow-hidden relative">
        <!-- Toggle Dark Mode Button -->
        <button class="toggle-dark" onclick="toggleDarkMode()">🌙/☀️</button>

        <div class="bg-blue-800 py-3 px-6">
            <h1 id="header" class="text-2xl font-bold text-white text-center cursor-pointer">
                HỆ THỐNG THÔNG TIN XE BUÝT
            </h1>
        </div>

        <div class="grid grid-cols-5 gap-4 p-6">
            <!-- Left Column - Buttons -->
            <div class="col-span-1 flex flex-col space-y-4">
                <button onclick="selectBus(8)" class="bus-btn py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500">Xe số 8</button>
                <button onclick="selectBus(9)" class="bus-btn py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500">Xe số 9</button>
                <button onclick="selectBus(10)" class="bus-btn py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500">Xe số 10</button>
                <!-- Payment buttons -->
                <button id="payment-button" class="py-3 px-4 bg-yellow-600 hover:bg-yellow-700 text-white font-semibold rounded-lg transition transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-yellow-500" onclick="showBankPaymentLink()">Thanh toán bằng ngân hàng</button>
                <button id="momo-payment-button" class="py-3 px-4 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg transition transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500" onclick="showPaymentLink()">Thanh toán bằng MoMo</button>
            </div>

            <!-- Middle Column - Info -->
            <div class="col-span-3 flex items-center justify-center">
                <div class="w-full h-64 bg-gray-50 border-2 border-gray-200 rounded-xl p-6 text-center">
                    <div class="bus-info h-full flex flex-col items-center justify-center space-y-2">
                        <img id="bus-image" src="" alt="" class="w-48 mb-4 rounded-lg hidden" />
                        <p class="text-5xl font-bold text-gray-800" id="bus-number">Hãy chọn xe</p>
                        <p class="text-lg text-gray-600" id="bus-details"></p>
                        <p class="text-lg text-gray-600" id="frequency"></p>
                        <p id="cancellation-message" class="cancel-message">Chuyến xe đã bị hủy.</p>
                        <p id="prompt-message" class="prompt-message">Vui lòng nhấn chọn xe</p>
                    </div>
                </div>
            </div>

            <!-- Right Column - LEDs -->
            <div class="col-span-1 flex flex-col items-center justify-center space-y-8">
                <div class="led-indicator w-12 h-12 rounded-full bg-red-500 led-off" id="led-8"></div>
                <div class="led-indicator w-12 h-12 rounded-full bg-red-500 led-off" id="led-9"></div>
                <div class="led-indicator w-12 h-12 rounded-full bg-red-500 led-off" id="led-10"></div>
            </div>
        </div>

        <div class="bg-blue-50 py-4 px-6 text-center border-t border-gray-200">
            <p class="text-blue-800">Bảng thông tin cập nhật lúc: <span id="update-time" class="font-semibold"></span></p>
        </div>
    </div>

    <script>
        const busData = {
            8: {
                route: "Bến Thành - Chợ Lớn",
                frequency: "15 phút/chuyến",
                status: "Đang hoạt động",
                image: "xe8.jpg",
                alt: "Yellow city bus number 8, driving through downtown"
            },
            9: {
                route: "Bến Xe Miền Đông - Bến Xe An Sương",
                frequency: "10 phút/chuyến",
                status: "Đang hoạt động",
                image: "xe9.jpg",
                alt: "Green articulated bus with route number 9, traveling along a major highway"
            },
            10: {
                route: "Bến Xe Củ Chi - Khu Công Nghệ Cao",
                frequency: "25 phút/chuyến",
                status: "Chuẩn bị",
                image: "xe10.jpg",
                alt: "Blue electric bus number 10, parked at a terminal"
            }
        };

        let clickCount = 0;
        let lastBusNumber = null;

        document.addEventListener('DOMContentLoaded', () => {
            updateTime();
            setInterval(updateTime, 60000);
            document.getElementById('header').addEventListener('click', resetPage);
        });

        function resetPage() {
            lastBusNumber = null;
            clickCount = 0;

            document.getElementById('bus-number').textContent = "Hãy chọn xe";
            document.getElementById('bus-details').textContent = "";
            document.getElementById('frequency').textContent = "";
            document.getElementById('cancellation-message').style.display = 'none';
            document.getElementById('prompt-message').style.display = 'block';
            document.getElementById('bus-image').classList.add('hidden');

            document.querySelectorAll('.led-indicator').forEach(led => {
                led.classList.remove('led-on');
                led.classList.add('led-off');
            });
        }

        function selectBus(busNumber) {
            const img = document.getElementById('bus-image');
            const cancellationMessage = document.getElementById('cancellation-message');
            const promptMessage = document.getElementById('prompt-message');

            cancellationMessage.style.display = 'none';
            promptMessage.style.display = 'none';

            if (lastBusNumber === busNumber) {
                clickCount++;
            } else {
                clickCount = 1;
            }
            lastBusNumber = busNumber;

            if (clickCount === 2) {
                document.getElementById(`led-${busNumber}`).classList.remove('led-on');
                document.getElementById(`led-${busNumber}`).classList.add('led-off');
                cancellationMessage.style.display = 'block';
                document.getElementById('bus-number').textContent = "Hãy chọn xe";
                document.getElementById('bus-details').textContent = "";
                document.getElementById('frequency').textContent = "";
                img.classList.add('hidden');
                promptMessage.style.display = 'block';
                clickCount = 0;
                return;
            }

            // Update info and image
            document.getElementById('bus-number').textContent = busNumber;
            document.getElementById('bus-details').textContent = `Tuyến đường: ${busData[busNumber].route}`;
            document.getElementById('frequency').textContent = `Tần suất: ${busData[busNumber].frequency}`;
            img.src = busData[busNumber].image;
            img.alt = busData[busNumber].alt;
            img.classList.remove('hidden');

            // Update LEDs
            document.querySelectorAll('.led-indicator').forEach(led => {
                led.classList.remove('led-on');
                led.classList.add('led-off');
            });
            document.getElementById(`led-${busNumber}`).classList.remove('led-off');
            document.getElementById(`led-${busNumber}`).classList.add('led-on');
        }

        function updateTime() {
            const now = new Date();
            const options = {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            };
            document.getElementById('update-time').textContent = now.toLocaleDateString('vi-VN', options);
        }

        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
        }

        function showPaymentLink() {
            // Liên kết thanh toán MoMo
            const momoLink = "https://www.momo.vn/ve-xe?fromType=nav_menu"; // Liên kết chuyển tiền MoMo

            // Mở liên kết trong tab mới
            window.open(momoLink, '_blank');
        }

        function showBankPaymentLink() {
            // Liên kết thanh toán MB Bank
            const bankLink = "mbbank://"; // URL scheme cho MB Bank

            // Mở liên kết trong cùng một tab
            window.open(bankLink, '_self');
        }
    </script>
</body>
</html>
